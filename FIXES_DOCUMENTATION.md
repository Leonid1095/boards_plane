# üîß –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º PLGames Board

## üìã –û–±–∑–æ—Ä –ø—Ä–æ–±–ª–µ–º –∏ —Ä–µ—à–µ–Ω–∏–π

–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: **December 3, 2024**

### ‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 1. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—É—Ç—è–º–∏ –≤ docker-compose**
- **–°–∏–º–ø—Ç–æ–º**: `lstat /opt/plgames/plgames/packages/frontend/apps: no such file or directory`
- **–ü—Ä–∏—á–∏–Ω–∞**: Docker-compose –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ Dockerfile
- **–ü—É—Ç—å –≤ –∫–æ–¥–µ**:
  - `docker-compose.yml:47`
  - `docker-compose.prod.yml:38`

#### 2. **–û—à–∏–±–∫–∞ —Å package.json –≤ Docker-—Å–±–æ—Ä–∫–µ**
- **–°–∏–º–ø—Ç–æ–º**: `Invalid package.json in package.json`
- **–ü—Ä–∏—á–∏–Ω–∞**: Dockerfile.plgames –∏—Å–∫–∞–ª package.json –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –º–µ—Å—Ç–µ, –Ω–æ docker-compose –ø–µ—Ä–µ–¥–∞–≤–∞–ª –Ω–µ–≤–µ—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- **–ü—É—Ç—å –≤ –∫–æ–¥–µ**: `plgames/Dockerfile.plgames:24`

#### 3. **–ü—Ä–æ–±–ª–µ–º–∞ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏**
- **–°–∏–º–ø—Ç–æ–º**: `‚ö† –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è /opt/plgames —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞`
- **–ü—Ä–∏—á–∏–Ω–∞**: –£—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- **–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã**: `install.sh`, `install-improved.sh`

#### 4. **–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è Caddyfile**
- **–°–∏–º–ø—Ç–æ–º**: –ù–µ —É–¥–∞–≤–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ Caddyfile –ø—Ä–∏ —Å–±–æ—Ä–∫–µ frontend
- **–ü—Ä–∏—á–∏–Ω–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å –≤ Dockerfile
- **–ü—É—Ç—å –≤ –∫–æ–¥–µ**: `plgames/packages/frontend/apps/web/Dockerfile:17`

#### 5. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞**
- **–°–∏–º–ø—Ç–æ–º**: `‚ö† –ú–∞–ª–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ: 9GB (—Ç—Ä–µ–±—É–µ—Ç—Å—è 20GB)`
- **–ü—Ä–∏—á–∏–Ω–∞**: Docker –∑–∞–Ω–∏–º–∞–ª –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞ —Å—Ç–∞—Ä—ã–º–∏ –æ–±—Ä–∞–∑–∞–º–∏ –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏

---

## ‚úÖ –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ docker-compose.yml

**–§–∞–π–ª**: `docker-compose.yml:47`

```yaml
# –î–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
frontend:
  build:
    context: ./plgames
    dockerfile: packages/frontend/apps/web/Dockerfile

# –ü–û–°–õ–ï (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
frontend:
  build:
    context: ./plgames
    dockerfile: ./packages/frontend/apps/web/Dockerfile
```

**–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å**: –î–æ–±–∞–≤–ª–µ–Ω `./` –ø–µ—Ä–µ–¥ –ø—É—Ç–µ–º –∫ Dockerfile –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏.

---

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ docker-compose.prod.yml

**–§–∞–π–ª**: `docker-compose.prod.yml:38`

```yaml
# –î–û:
frontend:
  build:
    context: ./plgames
    dockerfile: packages/frontend/apps/web/Dockerfile

# –ü–û–°–õ–ï:
frontend:
  build:
    context: ./plgames
    dockerfile: ./packages/frontend/apps/web/Dockerfile
```

---

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Frontend Dockerfile

**–§–∞–π–ª**: `plgames/packages/frontend/apps/web/Dockerfile:17`

```dockerfile
# –î–û:
COPY packages/frontend/apps/web/Caddyfile /etc/caddy/Caddyfile

# –ü–û–°–õ–ï:
COPY ./packages/frontend/apps/web/Caddyfile /etc/caddy/Caddyfile
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ**: –ü—É—Ç—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ build context (./plgames), –ø–æ—ç—Ç–æ–º—É —Ç—Ä–µ–±—É–µ—Ç—Å—è `./` –≤ –Ω–∞—á–∞–ª–µ.

---

### 4. –ù–æ–≤—ã–π —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç: install-fixed.sh

**–§–∞–π–ª**: `install-fixed.sh` (–Ω–æ–≤—ã–π)

**–ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏**:

‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏
‚úÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è (–æ–±–Ω–æ–≤–∏—Ç—å/–ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å/–æ—Ç–º–µ–Ω–∏—Ç—å)
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ .env –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –æ—á–∏—Å—Ç–∫–∏
‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–±–æ—Ä–∫–∏
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

```bash
check_existing_installation()  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã
setup_repository()             # –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
configure_project()            # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
build_and_start()             # –°–±–æ—Ä–∫–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
check_health()                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
```

---

### 5. –°–∫—Ä–∏–ø—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è: restart.sh

**–§–∞–π–ª**: `restart.sh` (–Ω–æ–≤—ã–π)

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã**:

```bash
bash restart.sh status    # –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ + health check
bash restart.sh restart   # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
bash restart.sh rebuild   # –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤
bash restart.sh start     # –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
bash restart.sh stop      # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
bash restart.sh logs      # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
bash restart.sh logs backend  # –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
bash restart.sh cleanup   # –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (—É–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ docker-compose —Ñ–∞–π–ª–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ (PostgreSQL, Backend, Frontend)
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–ª—è –æ–ø–∞—Å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–≥–æ–≤ —Å–±–æ—Ä–∫–∏ –≤ `/tmp/plgames-rebuild.log`

---

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```bash
# –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç —É–∂–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
cd /opt/plgames
git pull origin main

# –ò–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ scp:
scp docker-compose.yml root@your-server:/opt/plgames/
scp docker-compose.prod.yml root@your-server:/opt/plgames/
scp install-fixed.sh root@your-server:/opt/plgames/
scp restart.sh root@your-server:/opt/plgames/
scp plgames/packages/frontend/apps/web/Dockerfile root@your-server:/opt/plgames/plgames/packages/frontend/apps/web/
```

### –®–∞–≥ 2: –î–∞—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞–º

```bash
chmod +x install-fixed.sh
chmod +x restart.sh
```

### –®–∞–≥ 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å install-fixed.sh –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
# –ï—Å–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è /opt/plgames —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:
cd /opt/plgames
bash install-fixed.sh

# –°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç –≤—ã–±–æ—Ä:
# 1) –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É (—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ)
# 2) –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (—É–¥–∞–ª–∏—Ç—å –≤—Å–µ –∏ –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ)
# 3) –û—Ç–º–µ–Ω–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É

# –í—ã–±–∏—Ä–∞–π—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç 1 –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```bash
bash restart.sh status
```

---

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/opt/plgames/
‚îú‚îÄ‚îÄ docker-compose.yml              # –û—Å–Ω–æ–≤–Ω–æ–π compose —Ñ–∞–π–ª (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π)
‚îú‚îÄ‚îÄ docker-compose.prod.yml         # Production –≤–µ—Ä—Å–∏—è
‚îú‚îÄ‚îÄ .env                            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ install-fixed.sh                # –ù–æ–≤—ã–π —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ (—Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π)
‚îú‚îÄ‚îÄ restart.sh                      # –°–∫—Ä–∏–ø—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞–º–∏
‚îî‚îÄ‚îÄ plgames/                        # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞
    ‚îú‚îÄ‚îÄ package.json                # ‚úÖ –ö–æ—Ä–Ω–µ–≤–æ–π package.json (–¥–ª—è yarn workspace)
    ‚îú‚îÄ‚îÄ Dockerfile.plgames          # Dockerfile –¥–ª—è backend
    ‚îú‚îÄ‚îÄ packages/
    ‚îÇ   ‚îú‚îÄ‚îÄ backend/
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ server/
    ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Dockerfile      # Backend Dockerfile
    ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ...
    ‚îÇ   ‚îî‚îÄ‚îÄ frontend/
    ‚îÇ       ‚îî‚îÄ‚îÄ apps/
    ‚îÇ           ‚îî‚îÄ‚îÄ web/
    ‚îÇ               ‚îú‚îÄ‚îÄ Dockerfile  # ‚úÖ Frontend Dockerfile (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω)
    ‚îÇ               ‚îî‚îÄ‚îÄ Caddyfile   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞
    ‚îî‚îÄ‚îÄ ...
```

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: Backend –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–±–æ—Ä–∫–∏
docker compose build backend 2>&1 | tee build.log

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ package.json —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls -la plgames/package.json

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Docker context
docker compose config
```

### –ü—Ä–æ–±–ª–µ–º–∞: Frontend –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Dockerfile —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls -la plgames/packages/frontend/apps/web/Dockerfile

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ Caddyfile —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls -la plgames/packages/frontend/apps/web/Caddyfile

# 3. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å —Å –ª–æ–≥–∞–º–∏
docker compose build --no-cache frontend 2>&1 | tee frontend-build.log
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°–µ—Ä–≤–∏—Å—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
bash restart.sh status

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
bash restart.sh logs

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
bash restart.sh logs backend
bash restart.sh logs frontend

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã
docker stats

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç—å
docker network ls
docker network inspect plgames_plgames-network
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Ç–µ–π Docker

```bash
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—É—Ç–∏
docker compose config | grep dockerfile

# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:
# dockerfile: ./packages/frontend/apps/web/Dockerfile
```

### –¢–µ—Å—Ç 2: –°–±–æ—Ä–∫–∞ backend

```bash
cd /opt/plgames
docker compose build backend

# –î–æ–ª–∂–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫:
# ‚úÖ [+] Building ... done
```

### –¢–µ—Å—Ç 3: –°–±–æ—Ä–∫–∞ frontend

```bash
docker compose build frontend

# –î–æ–ª–∂–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫:
# ‚úÖ [+] Building ... done
```

### –¢–µ—Å—Ç 4: –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
bash restart.sh start

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥:
bash restart.sh status

# –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å "healthy" –∏–ª–∏ "running"
```

### –¢–µ—Å—Ç 5: Health checks

```bash
# PostgreSQL
docker compose exec postgres pg_isready

# Backend
curl -f http://localhost:3010/api/healthz

# Frontend
curl -f http://localhost:8080
```

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º

- [ ] Git pull –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (`ls -la plgames/`)
- [ ] –ü—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ (`chmod +x *.sh`)
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è .env —Ñ–∞–π–ª–∞
- [ ] –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (`docker compose down`)
- [ ] –û—á–∏—Å—Ç–∫–∞ Docker –∫—ç—à–∞ –µ—Å–ª–∏ –º–∞–ª–æ –º–µ—Å—Ç–∞ (`docker system prune -af`)
- [ ] –ó–∞–ø—É—Å–∫ install-fixed.sh –∏–ª–∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ —á–µ—Ä–µ–∑ restart.sh
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ frontend –∏ backend
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ health checks –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

---

## üÜò –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### "Invalid package.json"

**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `plgames/package.json` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–ª–∏–¥–Ω—ã–π JSON.

```bash
cat plgames/package.json | jq .
```

### "no such file or directory: Caddyfile"

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Caddyfile —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –ø—É—Ç—å –≤ Dockerfile –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.

```bash
ls -la plgames/packages/frontend/apps/web/Caddyfile
```

### "Cannot connect to backend"

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω –∏ healthcheck –ø—Ä–æ—Ö–æ–¥–∏—Ç.

```bash
bash restart.sh logs backend
curl -v http://localhost:3010/api/healthz
```

### "Port already in use"

**–†–µ—à–µ–Ω–∏–µ**: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∑–∞–Ω–∏–º–∞—é—â–∏–µ –ø–æ—Ä—Ç—ã –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç—ã –≤ .env.

```bash
# –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É 3010
sudo lsof -i :3010
sudo lsof -i :8080

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker —Å–µ—Ä–≤–∏—Å—ã
bash restart.sh stop

# –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç—ã –≤ .env
nano .env
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **–û—Å–Ω–æ–≤–Ω–æ–π README**: [README.md](./README.md)
- **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç**: [INSTALL.md](./INSTALL.md)
- **Docker –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: https://docs.docker.com/
- **Docker Compose reference**: https://docs.docker.com/compose/compose-file/

---

## ‚ú® –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

### ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. ‚úÖ –ü—É—Ç–∏ –∫ Dockerfile –≤ docker-compose.yml
2. ‚úÖ –ü—É—Ç–∏ –∫ Dockerfile –≤ docker-compose.prod.yml
3. ‚úÖ –ü—É—Ç—å –∫ Caddyfile –≤ Frontend Dockerfile
4. ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏
5. ‚úÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏
6. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤
7. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ –º–µ—Å—Ç–∞

### üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

- ‚úÖ Backend –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ Frontend –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ PostgreSQL –∏ Redis —Ä–∞–±–æ—Ç–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
- ‚úÖ –í—Å–µ health checks –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º—É URL

---

**–ê–≤—Ç–æ—Ä**: Claude Code AI Assistant
**–î–∞—Ç–∞**: 2024-12-03
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**: 1.0
