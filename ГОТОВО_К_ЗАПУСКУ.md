# PLGames - ะะะขะะะ ะ ะะะะฃะกะะฃ! ๐

## ะงัะพ ัะดะตะปะฐะฝะพ (6 ะดะตะบะฐะฑัั 2024)

### โ ะัะฟัะฐะฒะปะตะฝ Dockerfile.plgames

**ะัะพะฑะปะตะผะฐ ะฑัะปะฐ:**
- Alpine Linux (ะฝะตัะพะฒะผะตััะธะผ ั Prisma)
- ะััััััะฒะธะต ะฝะฐัะธะฒะฝัั ะทะฐะฒะธัะธะผะพััะตะน
- ะะตะฟัะฐะฒะธะปัะฝัะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

**ะัะฟัะฐะฒะปะตะฝะพ:**
- โ Debian Bookworm (ัะพะฒะผะตััะธะผ ั Prisma)
- โ ะัะต ัะธััะตะผะฝัะต ะทะฐะฒะธัะธะผะพััะธ (libvips, openssl, build tools)
- โ ะัะฐะฒะธะปัะฝัะต ะฟะตัะตะผะตะฝะฝัะต Prisma
- โ Multi-stage build ะดะปั ะพะฟัะธะผะธะทะฐัะธะธ ัะฐะทะผะตัะฐ

**ะคะฐะนะป:** [plgames/Dockerfile.plgames](plgames/Dockerfile.plgames)

### โ ะกะพะทะดะฐะฝ .dockerignore

ะะฟัะธะผะธะทะธััะตั ัะฑะพัะบั, ะธัะบะปััะฐั ะฝะตะฝัะถะฝัะต ัะฐะนะปั.

**ะคะฐะนะป:** [plgames/.dockerignore](plgames/.dockerignore)

### โ ะกะพะทะดะฐะฝะฐ ะดะพะบัะผะตะฝัะฐัะธั

1. **[ะะซะกะขะะซะ_ะกะขะะะข.md](ะะซะกะขะะซะ_ะกะขะะะข.md)** - ะฟะพัะฐะณะพะฒะฐั ะธะฝััััะบัะธั ะทะฐะฟััะบะฐ
2. **[DOCKER_BUILD_FIX.md](DOCKER_BUILD_FIX.md)** - ัะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ ะธัะฟัะฐะฒะปะตะฝะธะน
3. **[PROBLEM_ANALYSIS.md](PROBLEM_ANALYSIS.md)** - ะฐะฝะฐะปะธะท ะฟัะพะฑะปะตะผ (ะฟะพัะตะผั ะผะตััั ะฝะต ัะฐะฑะพัะฐะปะพ)
4. **[COMMANDS.md](COMMANDS.md)** - ัะฟัะฐะฒะพัะฝะธะบ ะฒัะตั ะบะพะผะฐะฝะด
5. **[quick-deploy.sh](quick-deploy.sh)** - ัะบัะธะฟั ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ะทะฐะฟััะบะฐ

### โ ะะพัะพะฒะฐ ะบะพะฝัะธะณััะฐัะธั

**ะคะฐะนะป:** [.env](.env)
- Database: PostgreSQL (ะณะพัะพะฒะพ)
- Redis: ะฝะฐัััะพะตะฝ
- ะะพััั: 3010 (backend), 8080 (frontend)
- ะัะต ะฑะฐะทะพะฒัะต ะฟะฐัะฐะผะตััั ะฝะฐัััะพะตะฝั

## ะะะะฃะกะ ะ 1 ะะะะะะะฃ

```bash
bash quick-deploy.sh
```

ะญัะพั ัะบัะธะฟั:
1. ะัะพะฒะตัะธั Docker
2. ะััะฐะฝะพะฒะธั ััะฐััะต ะบะพะฝัะตะนะฝะตัั
3. ะกะพะฑะตัะตั ะพะฑัะฐะทั (~10-20 ะผะธะฝัั)
4. ะะฐะฟัััะธั ะฒัะต ัะตัะฒะธัั
5. ะัะพะฒะตัะธั ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััั
6. ะะพะบะฐะถะตั URL ะดะปั ะดะพัััะฟะฐ

## ะะปะธ ัััะฝะพะน ะทะฐะฟััะบ (3 ะบะพะผะฐะฝะดั)

```bash
docker compose down
docker compose build --no-cache
docker compose up -d
```

## ะะพัะปะต ะทะฐะฟััะบะฐ

ะัะบัะพะนัะต ะฒ ะฑัะฐัะทะตัะต:

- **Frontend:** http://localhost:8080
- **Backend API:** http://localhost:3010
- **GraphQL Playground:** http://localhost:3010/graphql

## ะัะพะฒะตัะบะฐ ัะฐะฑะพัั

```bash
# ะกัะฐััั ะบะพะฝัะตะนะฝะตัะพะฒ
docker compose ps

# ะะพะณะธ backend
docker compose logs -f backend

# ะัะพะฒะตัะบะฐ API
curl http://localhost:3010/api/healthz
```

## ะัะปะธ ััะพ-ัะพ ะฝะต ัะฐะฑะพัะฐะตั

### 1. ะะพัะผะพััะธัะต ะปะพะณะธ

```bash
docker compose logs --tail=100 backend
```

### 2. ะะตัะตะทะฐะฟัััะธัะต

```bash
docker compose restart backend
```

### 3. ะะตัะตัะพะฑะตัะธัะต

```bash
docker compose build --no-cache backend
docker compose up -d backend
```

### 4. ะะพะปะฝะฐั ะฟะตัะตัะฑะพัะบะฐ

```bash
docker compose down -v
docker system prune -af
bash quick-deploy.sh
```

## ะกัััะบัััะฐ ัะฐะนะปะพะฒ

```
.
โโโ plgames/
โ   โโโ Dockerfile.plgames      โ ะะกะะะะะะะ
โ   โโโ .dockerignore           โ ะกะะะะะ
โ   โโโ packages/
โ   โ   โโโ backend/server/     Backend (NestJS + Prisma)
โ   โ   โโโ frontend/           Frontend (React)
โ   โโโ package.json
โ
โโโ docker-compose.yml          ะะพะฝัะธะณััะฐัะธั Docker
โโโ .env                        ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
โ
โโโ quick-deploy.sh             โ ะะฒัะพะผะฐัะธัะตัะบะธะน ะทะฐะฟััะบ
โโโ ะะซะกะขะะซะ_ะกะขะะะข.md           โ ะะฝััััะบัะธั
โโโ DOCKER_BUILD_FIX.md        โ ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ
โโโ PROBLEM_ANALYSIS.md        โ ะะฝะฐะปะธะท ะฟัะพะฑะปะตะผ
โโโ COMMANDS.md                โ ะกะฟัะฐะฒะพัะฝะธะบ ะบะพะผะฐะฝะด
โโโ ะะะขะะะ_ะ_ะะะะฃะกะะฃ.md        โ ะญัะพั ัะฐะนะป
```

## ะะพัะตะผั ัะตะฟะตัั ะฑัะดะตั ัะฐะฑะพัะฐัั

### ะะ (ะฝะต ัะฐะฑะพัะฐะปะพ ะผะตััั)

โ Alpine Linux โ Prisma ะฝะต ัะพะฒะผะตััะธะผ
โ ะะตั libvips โ Sharp ะฝะต ัะพะฑะธัะฐะตััั
โ ะะตั ะฟะตัะตะผะตะฝะฝัั Prisma โ engines ะฝะต ะฝะฐัะพะดัััั
โ ะะพะฝัะปะธะบั ะฒะตััะธะน โ ัะฐะทะฝัะต ะฒะตััะธะธ Prisma
โ ะะตะฟัะฐะฒะธะปัะฝะฐั ััััะบัััะฐ โ ัะผะตัั Plane + AFFiNE

### ะะะกะะ (ะดะพะปะถะฝะพ ัะฐะฑะพัะฐัั)

โ Debian Bookworm โ Prisma ัะพะฒะผะตััะธะผ
โ ะฃััะฐะฝะพะฒะปะตะฝ libvips โ Sharp ัะฐะฑะพัะฐะตั
โ ะะฐัััะพะตะฝั ะฟะตัะตะผะตะฝะฝัะต โ Prisma engines ะฝะฐ ะผะตััะต
โ ะงะธััะฐั ััััะบัััะฐ โ AFFINE ะบะฐะบ ะพัะฝะพะฒะฐ
โ ะะฟัะธะผะธะทะธัะพะฒะฐะฝะฝะฐั ัะฑะพัะบะฐ โ fast ะธ ะฝะฐะดะตะถะฝะพ

## ะงัะพ ะดะฐะปััะต (ะฟะพัะปะต ะทะฐะฟััะบะฐ)

### ะัะฐัะบะพััะพัะฝะพ (1-3 ะดะฝั)

1. ะัะพะฒะตัะธัั ะฑะฐะทะพะฒัะน ััะฝะบัะธะพะฝะฐะป AFFINE
2. ะฃะฑะตะดะธัััั ััะพ ะฒัะต ัะฐะฑะพัะฐะตั ััะฐะฑะธะปัะฝะพ
3. ะะฐัััะพะธัั ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ััะฝะบัะธะธ (AI, OAuth)

### ะกัะตะดะฝะตััะพัะฝะพ (1-2 ะฝะตะดะตะปะธ)

1. ะะฝัะตะณัะธัะพะฒะฐัั CRM ะธะท Plane
2. ะะฐัััะพะธัั CI/CD
3. ะะฟัะธะผะธะทะธัะพะฒะฐัั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

### ะะพะปะณะพััะพัะฝะพ (1+ ะผะตััั)

1. ะะพะฑะฐะฒะธัั ะผะพะฝะธัะพัะธะฝะณ (Prometheus, Grafana)
2. ะะฐัััะพะธัั ะฐะฒัะพะผะฐัะธัะตัะบะธะต ะฑัะบะฐะฟั
3. ะะฐัััะฐะฑะธัะพะฒะฐะฝะธะต (ะตัะปะธ ะฝัะถะฝะพ)

## ะัะฝะพะฒะฝัะต ะบะพะผะฐะฝะดั

### ะฃะฟัะฐะฒะปะตะฝะธะต

```bash
docker compose up -d         # ะะฐะฟัััะธัั
docker compose down          # ะััะฐะฝะพะฒะธัั
docker compose restart       # ะะตัะตะทะฐะฟัััะธัั
docker compose ps            # ะกัะฐััั
docker compose logs -f       # ะะพะณะธ
```

### ะะธะฐะณะฝะพััะธะบะฐ

```bash
curl http://localhost:3010/api/healthz     # ะัะพะฒะตัะบะฐ API
docker compose logs -f backend             # ะะพะณะธ backend
docker compose exec backend bash           # ะะฐะนัะธ ะฒ ะบะพะฝัะตะนะฝะตั
```

### ะะฐะฑะพัะฐ ั ะะ

```bash
# ะะพะดะบะปััะธัััั ะบ PostgreSQL
docker compose exec postgres psql -U plgames -d plgames

# ะัะบะฐะฟ
docker compose exec postgres pg_dump -U plgames plgames > backup.sql
```

## ะกะธััะตะผะฝัะต ััะตะฑะพะฒะฐะฝะธั

- **Docker:** 20.10+
- **Docker Compose:** 2.0+
- **RAM:** 4GB ะผะธะฝะธะผัะผ (8GB ัะตะบะพะผะตะฝะดัะตััั)
- **Disk:** 15GB ัะฒะพะฑะพะดะฝะพะณะพ ะผะตััะฐ
- **CPU:** 2+ ัะดัะฐ

## ะะพััั

- `3010` - Backend API
- `8080` - Frontend
- `5432` - PostgreSQL
- `6379` - Redis (ัะพะปัะบะพ ะฒะฝัััะธ Docker)

## ะะพะดะดะตัะถะบะฐ

### ะะพะปะตะทะฝัะต ัะฐะนะปั ะดะปั ะดะธะฐะณะฝะพััะธะบะธ

ะัะปะธ ะฝัะถะฝะฐ ะฟะพะผะพัั, ัะพะฑะตัะธัะต ะธะฝัะพัะผะฐัะธั:

```bash
# ะกัะฐััั
docker compose ps > status.txt

# ะะพะณะธ
docker compose logs --tail=200 backend > backend.log
docker compose logs --tail=100 postgres > postgres.log

# ะะพะฝัะธะณััะฐัะธั
docker compose config > compose-config.yml
```

### ะะพะบัะผะตะฝัะฐัะธั

- **AFFINE GitHub:** https://github.com/toeverything/AFFiNE
- **AFFINE Docs:** https://docs.affine.pro
- **Prisma Docs:** https://www.prisma.io/docs
- **Docker Docs:** https://docs.docker.com

## ะงะตะบะปะธัั ะฟะตัะตะด ะทะฐะฟััะบะพะผ

- [ ] Docker ัััะฐะฝะพะฒะปะตะฝ ะธ ะทะฐะฟััะตะฝ
- [ ] ะะพััะฐัะพัะฝะพ ะผะตััะฐ ะฝะฐ ะดะธัะบะต (15+ GB)
- [ ] ะะพััั 3010 ะธ 8080 ัะฒะพะฑะพะดะฝั
- [ ] ะคะฐะนะป .env ัััะตััะฒัะตั ะธ ะฝะฐัััะพะตะฝ
- [ ] ะั ะฒ ะบะพัะฝะตะฒะพะน ะดะธัะตะบัะพัะธะธ ะฟัะพะตะบัะฐ

## ะะะะฃะกะะะะขะ! ๐

ะขะตะฟะตัั ะฒัะต ะณะพัะพะฒะพ. ะัะฟะพะปะฝะธัะต:

```bash
bash quick-deploy.sh
```

ะะปะธ ะฒัััะฝัั:

```bash
docker compose build --no-cache && docker compose up -d
```

## ะะพัะปะต ััะฟะตัะฝะพะณะพ ะทะฐะฟััะบะฐ

ะั ัะฒะธะดะธัะต:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  ะะฝัะพัะผะฐัะธั ะดะปั ะดะพัััะฟะฐ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ Frontend:     http://localhost:8080
๐ง Backend API:  http://localhost:3010
๐ GraphQL:      http://localhost:3010/graphql
๐พ ะะฐะทะฐ ะดะฐะฝะฝัั:  PostgreSQL ะฝะฐ ะฟะพััั 5432

โ PLGames ััะฟะตัะฝะพ ะทะฐะฟััะตะฝ!
```

## ะะฐะถะฝะพ

ะญัะพ **AFFINE ะบะฐะบ ะพัะฝะพะฒะฐ**, CRM ะธะท Plane ะฑัะดะตั ะธะฝัะตะณัะธัะพะฒะฐะฝ ะฟะพะทะถะต.

ะกะฝะฐัะฐะปะฐ ัะฑะตะดะธัะตัั ััะพ ะฑะฐะทะพะฒัะน AFFINE ัะฐะฑะพัะฐะตั, ะฟะพัะพะผ ะดะพะฑะฐะฒะปัะนัะต ััะฝะบัะธะพะฝะฐะป.

---

**ะะฐัะฐ ะธัะฟัะฐะฒะปะตะฝะธั:** 6 ะดะตะบะฐะฑัั 2024
**ะกัะฐััั:** โ ะะะขะะะ ะ ะะะะฃะกะะฃ
**ะัะฝะพะฒะฐ:** AFFINE (toeverything/AFFiNE)
**ะะปะฐะฝะธััะตััั:** ะะฝัะตะณัะฐัะธั CRM ะธะท Plane

**ะะะะฃะกะะะะขะ ะ ะะะจะะขะ ะะะะฃะะฌะขะะข!** ๐
